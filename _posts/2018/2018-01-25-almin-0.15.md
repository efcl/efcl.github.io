---
title: "Almin 0.15ãƒªãƒªãƒ¼ã‚¹"
author: azu
layout: post
date : 2018-01-25T10:56
category: JavaScript
tags:
    - JavaScript
    - Almin

---

ã‚¹ãƒ†ãƒ¼ãƒˆç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®[Almin](https://almin.js.org/ "Almin") 0.15ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã¾ã—ãŸã€‚

- [Release Almin 0.15.0 Â· almin/almin](https://github.com/almin/almin/releases/tag/almin%400.15.0 "Release Almin 0.15.0 Â· almin/almin")

## ğŸŒŸ Features

### `UseCase#shouldExecute`ã‚’ã‚µãƒãƒ¼ãƒˆ

`UseCase#shouldExecute`ã¯ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’å®Ÿè¡Œã™ã‚‹ã‹ã©ã†ã‹ã®äº‹å‰æ¡ä»¶ã‚’å®šç¾©ã§ãã¾ã™ã€‚

ä»Šã¾ã§ã®å•é¡Œã¨ã—ã¦ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’å®£è¨€çš„ã«å®Ÿè¡Œã™ã‚‹ã‹ã©ã†ã‹ã‚’æ±ºã‚ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã§ã—ãŸã€‚
å‹•ä½œã¨ã—ã¦ã¯`UseCase#execute()`ãŒå®Ÿè¡Œã•ã‚ŒãŸã¨ãã«æ¡ä»¶ãŒåˆã£ã¦ãªã‘ã‚Œã°returnã™ã‚Œã°æ©Ÿèƒ½ã¨ã—ã¦ã¯åŒã˜ã§ã™ã€‚

ã—ã‹ã—ã€[almin-logger](https://github.com/almin/almin/tree/master/packages/almin-logger "almin-logger")ãªã©ã®ã‚¤ãƒ™ãƒ³ãƒˆçš„ã«ã¯"å®Ÿè¡Œã—ãŸ"ã¨ã„ã†è¨˜éŒ²ãŒæ®‹ã£ã¦ã—ã¾ã†ã®ã§ã‚¤ãƒã‚¤ãƒã§ã—ãŸã€‚

```js
class MyUseCase extends UseCase {
    execute(args){
        if(condition){
             return; // Should not execute this UseCase
        }
        // do something
    }
}
```

`UseCase#shouldExecute`ã§ã¯ã“ã®ã‚±ãƒ¼ã‚¹ã‚’å®£è¨€çš„ã«è¡¨ç¾ã§ãã¾ã™ã€‚
`UseCase#shouldExecute`ã§`false`ã‚’è¿”ã›ã°ã€ãã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’å®Ÿè¡Œã—ã¾ã›ã‚“ã€‚

```js
class MyUseCase extends UseCase {
    shouldExecute(args): boolean {
         return false; // if this usecase should not execute
    }
    execute(args){
        // do something
    }
}
```

ã“ã®"å®Ÿè¡Œã—ãªã‹ã£ãŸ"ã¨ã„ã†ãƒ­ã‚°ã¯åˆ¥é€”`onWillNotExecuteEachUseCase`ã‚¤ãƒ™ãƒ³ãƒˆã§å–å¾—ã§ãã‚‹ã®ã§ãã¾ã™ã€‚
è©³ã—ãã¯[LifeCycleEventHub Â· Almin](https://almin.js.org/docs/en/lifecycleeventhub-api.html "LifeCycleEventHub Â· Almin")ã‚’ã¿ã¦ãã ã•ã„ã€‚

## ğŸ“ Documentation

[Alminã®ã‚µã‚¤ãƒˆã‚’OSSãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ„ãƒ¼ãƒ«ã®docusaurusã§ä½œã‚Šç›´ã—ãŸ | Web Scratch](http://efcl.info/2017/12/26/docusaurus-almin/ "Alminã®ã‚µã‚¤ãƒˆã‚’OSSãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ„ãƒ¼ãƒ«ã®docusaurusã§ä½œã‚Šç›´ã—ãŸ | Web Scratch")ã§æ›¸ã„ãŸã‚ˆã†ã«Alminã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚µã‚¤ãƒˆã‚’ä½œã‚Šç›´ã—ã¾ã—ãŸã€‚

- <https://almin.js.org/>

![image](https://user-images.githubusercontent.com/19714/35078145-318fa092-fc44-11e7-83ff-a4a6e07f0ef8.png)


![cqrs patterns for javascript application 2018-01-18 11-38-49](https://user-images.githubusercontent.com/19714/35078141-2a626f2a-fc44-11e7-874e-5cfebdee12f7.png)

ã¾ãŸã€ã„ãã¤ã‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ãŸã‚Šä¿®æ­£ã—ã¦ã„ã¾ã™ã€‚

Thanks to [@koba04](https://github.com/almin/almin/commits?author=koba04 "koba04").

ã¾ã ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã®å‰æ®µéšã®æ‰€ãŒã‚¤ãƒã‚¤ãƒãªã®ã§ç›´ã—ã¦ã„ããŸã„ã§ã™ã€‚

Alminã¯å¿…è¦ãªãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ†ã‘ã‚’ã™ã‚‹ãŸã‚ã«å¿…è¦ãªã‚‚ã®ã‚’ç½®ããŸã‚ã«ã€Reduxãªã©ã«æ¯”ã¹ã‚‹ã¨ç™»å ´äººç‰©ãŒå¤šã„ã§ã™ã€‚ã“ã‚Œã¯ã€ç‰¹åˆ¥ãªè¨˜æ³•ãªã©ã‚’å¢—ã‚„ã—ã¦ã¾ã§æ¸›ã‚‰ã™ã“ã¨ã¯ç›®çš„ã§ã¯ãªãã€å¿…è¦ãªã‚‚ã®ã¯ã¡ã‚ƒã‚“ã¨è¦‹ãˆã‚‹å½¢ã«ã™ã‚‹ã“ã¨ãŒç›®çš„ã«ã‚ã‚‹ã‹ã‚‰ã§ã™ã€‚

ãã®ãŸã‚ã“ã®è¾ºã®çŸ¥è­˜ãªã©ã‚’è£œå®Œã™ã‚‹ãŸã‚ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒã‚‚ã£ã¨ã‚ã‚‹ã¨ã„ã„ãªã¨ã„ã†æ„Ÿã˜ãŒã—ã¦ã„ã¾ã™ã€‚
(ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ä¾å­˜ã—ãŸã‚‚ã®ã¨ã„ã†ã‚ˆã‚Šã¯ã€ã‚ˆãã‚ã‚‹ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãªã©ã«ã‚‚ã§ã¦ãã‚‹ã‚ˆã†ãªçŸ¥è­˜ã€‚[Hanami](http://hanamirb.org/ "Hanami")ã¨ã‹[TERASOLUNA Server Framework](http://terasolunaorg.github.io/guideline/ "TERASOLUNA Server Framework")ã®ã‚ˆã†ãªãã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªåˆ©ç”¨è€…ä»¥å¤–ã«ã‚‚å½¹ç«‹ã¤ã¨ã‚ˆã‚Šè‰¯ã„ã€‚)

## ğŸ”¥ Breaking Change

ç ´å£Šçš„ãªå¤‰æ›´ãŒä¸€éƒ¨ã‚ã‚Šã¾ã™ãŒã€[almin/migration-tools](https://github.com/almin/migration-tools "almin/migration-tools: Migration scripts for Almin.")ã§ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ããŸã‚Šã€TypeScriptã®å‹ã®å•é¡Œã«ãªã£ã¦ã„ã¾ã™ã€‚

**TypeScript**

- `Payload`ã®`type`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å‹å®šç¾©ã‚’æ”¹å–„ã—ã¾ã—ãŸ
- `Payload`ã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿ã—ã¦ã‚‹äººã ã‘ã«å½±éŸ¿ãŒã‚ã‚Šã¾ã™ã€‚

**Before:**

ä»Šã¾ã§ã¯ã‚ˆããªã„ã‚‚ã®ãŒå‹ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚

```js
// OK
class P1 extends Payload{
    type = "P1"
}
// OK
class P2 extends Payload {
    type: string;
    constructor() {
        super({ type: "P2" });
    }
}
// OK
class P3 extends Payload{
    constructor() {
        super({ type: "P2" });
    }
}
// OK - It is a bug
class P4 extends Payload{
    // no type
}
```

**After:**

0.15ã§å‹ãƒã‚§ãƒƒã‚¯ãŒå³å¯†ã«ãªã‚Šã¾ã—ãŸã€‚

```js
// OK
class P1 extends Payload{
    type = "P1"
}
// OK
class P2 extends Payload {
    type: string;
    constructor() {
        super({ type: "P2" });
    }
}
// NG - Need to defined `type: string`
class P3 extends Payload{
    constructor() {
        super({ type: "P2" });
    }
}
// NG: Fix a bug #295 
class P4 extends Payload{
    // no type
}
```

### â™»ï¸ Remove deprecated API

- `Context#on*` APIãªã©ã‚’ `Context#events.on*` ã¸ç§»å‹•
	-  <https://github.com/almin/almin/issues/206>
- `ChangedPayload` ã‚’å‰Šé™¤ <https://github.com/almin/almin/issues/285>

ã“ã®ï¼’ã¤ã«å¤‰æ›´ã¯[@almin/migration-tools](https://github.com/almin/migration-tools "@almin/migration-tools")ã§è‡ªå‹•çš„ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ãã¾ã™ã€‚

### How to migrate?

`@almin/migration-tools`ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã€å¯¾è©±å¼ã§ç§»è¡Œã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚Œã°å¾Œã¯ã‚³ãƒ¼ãƒ‰ã‚’è‡ªå‹•çš„ã«å¤‰æ›ã—ã¦ãã‚Œã¾ã™ã€‚

```
npm install -g @almin/migration-tools
almin-migration-tools "src/**/*.js"
```

![screenshot](https://cdn.rawgit.com/almin/migration-tools/dbd1895e/docs/screen-shot.gif)


å®Ÿéš›ã«ã¯æ¬¡ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰å¤‰æ›´ãŒè¡Œã‚ã‚Œã¾ã™ã€‚

```js
import { UseCase, ChangedPayload } from "almin";

export class ExampleUseCase extends UseCase {
    execute() {
        this.context.useCase(new ChangedPayload()).execute();
    }
}
```

to 

```js
import { UseCase } from "almin";

export class ExampleUseCase extends UseCase {
    execute() {
        this.context.useCase({ type: "ChangedPayload" }).execute();
    }
}
```

ãã‚ã—ãã¯[@almin/migration-tools](https://github.com/almin/migration-tools "@almin/migration-tools")ã‚’è¦‹ã¦ãã ã•ã„ã€‚

ã¾ãŸã€ã“ã®ã‚ˆã†ãªãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«ã‚’ä½œã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚‚ä½œã‚Šã¾ã—ãŸã€‚

- [azu/code-migrator: Create code migration tool for your tool/library/framework.](https://github.com/azu/code-migrator "azu/code-migrator: Create code migration tool for your tool/library/framework.")

`code-migrator`ã‚’ä½¿ãˆã°ã€`1.0.0` -> `2.0.0`ã¸ã®ç§»è¡Œã¨ã„ã†ã‚ˆã†ãªå¯¾è©±CLIã‚’ç°¡å˜ã«ã¤ãã‚Œã¾ã™ã€‚å®Ÿéš›ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹å‡¦ç†ã¯jscodeshiftãªã©ã®ä»»æ„ã®codemodãƒ„ãƒ¼ãƒ«ã‚’ä½¿ãˆã‚‹ã®ã§ã€`code-migrator`è‡ªä½“ã¯é¸æŠã•ã‚ŒãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«å¯¾ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’èµ·å‹•ã™ã‚‹ã ã‘ã§ã™ã€‚

- [facebook/jscodeshift: A JavaScript codemod toolkit.](https://github.com/facebook/jscodeshift)
- [square/babel-codemod: babel-codemod rewrites JavaScript using babel plugins.](https://github.com/square/babel-codemod)
- [KnisterPeter/tscodeshift: tscodeshift is a toolkit for running codemods over multiple TS files](https://github.com/KnisterPeter/tscodeshift)


## ãã®ä»–

[kuker](https://github.com/krasimir/kuker "kuker")ã«å¯¾å¿œã—ãŸAlminã®DevToolsã‚’ä½œã£ãŸã‚Šã—ã¦ã„ã¾ã™ã€‚kukerã¯ã‚¤ãƒ™ãƒ³ãƒˆã®ãƒ­ã‚°ãƒ“ãƒ¥ãƒ¼ã‚¢æ‹¡å¼µãªã®ã§ã€ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã¡ã‚ƒã‚“ã¨å®šç¾©ã—ã¦ã‚‹Alminãªã©ã¨ã¯ç›¸æ€§ãŒã„ã„ã§ã™ã€‚(Redux-DevToolsç‰ˆã®[almin-devtools](https://github.com/almin/almin-devtools "almin-devtools")ã‚‚ã‚ã‚‹)

- [almin/almin-kuker-devtools: Integrate almin with kuker](https://github.com/almin/almin-kuker-devtools "almin/almin-kuker-devtools: Integrate almin with kuker")

![kuker](http://efcl.info/wp-content/uploads/2018/01/25-1516878025.png)

ã¾ãŸã€[Almin](https://almin.js.org/ "Almin")ã¯ã„ã¤ã§ã‚‚ã‚³ãƒ³ãƒˆãƒ“ãƒ¥ãƒ¼ãƒˆã‚’å‹Ÿé›†ã—ã¦ã„ã¾ã™ã€‚

[`label:"good first issue"`](https://github.com/almin/almin/issues?q=is%3Aissue+is%3Aopen+label%3A%22good+first+issue%22)ã¨ã„ã†ãƒ©ãƒ™ãƒ«ãŒã¤ã„ãŸIssueãªã©ãŒæ‰‹ãŒå‡ºã—ã‚„ã™ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

- [Make Dispatcher optional in Context Â· Issue #185 Â· almin/almin](https://github.com/almin/almin/issues/185 "Make Dispatcher optional in Context Â· Issue #185 Â· almin/almin")

ã¾ãŸã€Alminã¯[almin-react-container](https://github.com/almin/almin/tree/master/packages/almin-react-container "almin-react-container")ã¨ã„ã†Reacté€£æºç”¨ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚(è‡ªåˆ†ãŒReactã‚’ä½¿ã†ã“ã¨ãŒå¤šã„ã®ã§ä½œã£ãŸ)
æœ€è¿‘ã€ReactãŒ[æ–°ã—ã„Context API](https://github.com/facebook/react/pull/11818)ã‚„[Render Props](https://reactjs.org/docs/render-props.html "Render Props")ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¿½åŠ ãªã©ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¤‰åŒ–ãŒè¦‹ã‚‰ã‚Œã¾ã™ã€‚ãã®ãŸã‚Reactã¨ã®é€£æºã‚’ã™ã‚‹[almin-react-container](https://github.com/almin/almin/tree/master/packages/almin-react-container "almin-react-container")ã‚’æ–°ã—ãä½œã‚Šç›´ãã†ã¨ã—ã¦ã„ã¾ã™ã€‚(åˆ¥ç‰©ã‚’ä½œã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸)

ã“ã®è¾ºã«èˆˆå‘³ãŒã‚ã‚‹äººã¯æ¬¡ã®Issueã‚’è¦‹ã¦ã¿ã‚‹ã¨é¢ç™½ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

- [Render props for Almin + React Â· Issue #318 Â· almin/almin](https://github.com/almin/almin/issues/318)
- [Almin: Store#receivePayload design Â· Issue #312 Â· almin/almin](https://github.com/almin/almin/issues/312)
